library(tidyverse)
library(data.table)
read_table("data3.xlsx")
read_table2("data3.xlsx")
library(xlsx)
read.xlsx("data3.xlsx")
read.xlsx("data3.xlsx", 1)
political <- read.xlsx("data3.xlsx", 1)
political
g <- ggplot(political)
g + geom_bar(ideo_self)
g + geom_bar(aes(ideo_self))
?geom_bar
g + geom_bar(aes(ideo_self), position = "identity")
summary(political)
g + geom_bar(aes(ideo_self))
colSums(political)
colSums(political, na.rm = T)
colSums(political[9:20], na.rm = T)
colSums(political[9:19], na.rm = T)
colSums(political[9:18], na.rm = T)
nrow(political)
apply(political, 2, is.na())
apply(political, 2, colSums(is.na()))
apply(political, 1, colSums(is.na()))
is.na(political)
colSums(is.na(political))
colSums(political[9:18], na.rm = T)
nrow(political)
political$k3==2
which(political$k3==2)
head(political$k13)
head(political$k3)
political$k3[political$k3==2] <- 0
head(political)
colSums(is.na(political))
colSums(political[9:18], na.rm = T)
political[,"k2"==1]
political[,"k2"] == 1
k2is1 <- which(political[,"k2"] == 1)
k2is1
g <- ggplot(political[k2is1,])
g + geom_bar(aes(ideo_self))
g <- ggplot(political[-k2is1,])
g + geom_bar(aes(ideo_self))
ggplot(political[k2is1,]) + geom_bar(aes(ideo_self))
ggplot(political[-k2is1,]) + geom_bar(aes(ideo_self))
ggplot(political) + geom_bar(aes(ideo_self))
k3is1 <- which(political[,"k3"] == 1)
ggplot(political[k3is1,]) + geom_bar(aes(ideo_self))
ggplot(political[-k3is1,]) + geom_bar(aes(ideo_self))
ggplot(political[-k3is1,]) + geom_bar(aes(ideo_self))
ggplot(political[k2is1,]) + geom_bar(aes(ideo_self))
k4is1 <- which(political[,"k4"] == 1)
ggplot(political[k4is1,]) + geom_bar(aes(ideo_self))
ggplot(political[-k4is1,]) + geom_bar(aes(ideo_self))
k6is1 <- which(political[,"k6"] == 1)
ggplot(political[k6is1,]) + geom_bar(aes(ideo_self))
ggplot(political[-k6is1,]) + geom_bar(aes(ideo_self))
k7is1 <- which(political[,"k7"] == 1)
ggplot(political[k7is1,]) + geom_bar(aes(ideo_self))
ggplot(political[-k7is1,]) + geom_bar(aes(ideo_self))
ggplot(political[k6is1,]) + geom_bar(aes(ideo_self))
ggplot(political[-k6is1,]) + geom_bar(aes(ideo_self)) # progress
k8is1 <- which(political[,"k8"] == 1)
ggplot(political[k8is1,]) + geom_bar(aes(ideo_self))
ggplot(political[-k8is1,]) + geom_bar(aes(ideo_self))
k10is1 <- which(political[,"k10"] == 1)
ggplot(political[k10is1,]) + geom_bar(aes(ideo_self))
ggplot(political[-k10is1,]) + geom_bar(aes(ideo_self))
k12is1 <- which(political[,"k12"] == 1)
ggplot(political[k12is1,]) + geom_bar(aes(ideo_self))
ggplot(political[-k12is1,]) + geom_bar(aes(ideo_self))
k13is1 <- which(political[,"k13"] == 1)
ggplot(political[k13is1,]) + geom_bar(aes(ideo_self))
ggplot(political[-k13is1,]) + geom_bar(aes(ideo_self))
k14is1 <- which(political[,"k14"] == 1)
ggplot(political[k14is1,]) + geom_bar(aes(ideo_self))
ggplot(political[-k14is1,]) + geom_bar(aes(ideo_self))
ggplot(political[k14is1,]) + geom_bar(aes(ideo_self))
ggplot(political[-k10is1,]) + geom_bar(aes(ideo_self))
ggplot(political[k14is1,]) + geom_bar(aes(ideo_self)) # little conservative
ggplot(political[-k8is1,]) + geom_bar(aes(ideo_self)) # neutral
ggplot(political[k8is1,]) + geom_bar(aes(ideo_self)) # conservative
ggplot(political[k13is1,]) + geom_bar(aes(ideo_self)) # very conservative
ggplot(political[k8is1,]) + geom_bar(aes(ideo_self)) # very conservative
ggplot(political[k4is1,]) + geom_bar(aes(ideo_self)) # conservative
ggplot(political[-k4is1,]) + geom_bar(aes(ideo_self))
ggplot(political[k2is1,]) + geom_bar(aes(ideo_self)) # conservative
ggplot(political[-k2is1,]) + geom_bar(aes(ideo_self))
ggplot(political[k3is1,]) + geom_bar(aes(ideo_self)) # conservative
ggplot(political[-k3is1,]) + geom_bar(aes(ideo_self))
ggplot(political[k4is1,]) + geom_bar(aes(ideo_self)) # very conservative
ggplot(political[-k4is1,]) + geom_bar(aes(ideo_self)) # progress
k6is1 <- which(political[,"k6"] == 1)
ggplot(political[k6is1,]) + geom_bar(aes(ideo_self)) # conservative
ggplot(political[-k6is1,]) + geom_bar(aes(ideo_self)) # progress
k7is1 <- which(political[,"k7"] == 1)
ggplot(political[k7is1,]) + geom_bar(aes(ideo_self)) # conservative
ggplot(political[-k7is1,]) + geom_bar(aes(ideo_self)) # neutral
k8is1 <- which(political[,"k8"] == 1)
ggplot(political[k8is1,]) + geom_bar(aes(ideo_self)) # very conservative
ggplot(political[-k8is1,]) + geom_bar(aes(ideo_self)) # neutral
k10is1 <- which(political[,"k10"] == 1)
ggplot(political[k10is1,]) + geom_bar(aes(ideo_self)) # progress
ggplot(political[-k10is1,]) + geom_bar(aes(ideo_self)) # little conservative
k12is1 <- which(political[,"k12"] == 1)
ggplot(political[k12is1,]) + geom_bar(aes(ideo_self)) # progress
ggplot(political[-k12is1,]) + geom_bar(aes(ideo_self)) # conservative
k13is1 <- which(political[,"k13"] == 1)
ggplot(political[k13is1,]) + geom_bar(aes(ideo_self)) # very very conservative
ggplot(political[-k13is1,]) + geom_bar(aes(ideo_self)) # progress
k14is1 <- which(political[,"k14"] == 1)
ggplot(political[k14is1,]) + geom_bar(aes(ideo_self)) # little conservative
ggplot(political[-k14is1,]) + geom_bar(aes(ideo_self)) # little progress
ggplot(political[k14is1,]) + geom_bar(aes(ideo_self)) # little conservative
ggplot(political[-k14is1,]) + geom_bar(aes(ideo_self)) # little progress
ggplot(political[k2is1,]) + geom_bar(aes(ideo_self)) # conservative
ggplot(political[-k2is1,]) + geom_bar(aes(ideo_self)) # progress
ggplot(political[k3is1,]) + geom_bar(aes(ideo_self)) # conservative
ggplot(political) + geom_bar(aes(ideo_self))
political %>%
mutate(pred = ifelse(k2 == 1, 1, -1) +
ifelse(k3 == 1, 1, -1))
political %>%
mutate(pred = ifelse(k2 == 1, 1, ifelse(is.na(k2), 0, -1)) +
ifelse(k3 == 1, 1, ifelse(is.na(k3), 0, -1)))
ifelse(political$k2 == 1, 1, ifelse(is.na(political$k2), 0, -1)
)
ifelse(is.na(political$k2), 0, ifelse(political$k2==1, 1, -1))
ifelse(ifelse(is.na(k3), 0, ifelse(k3==1, 1, -1)))
political %>%
mutate(pred = ifelse(is.na(k2), 0, ifelse(k2==1, 1, -1))) +
ifelse(ifelse(is.na(k3), 0, ifelse(k3==1, 1, -1)))
head(political)
political %>%
mutate(pred = ifelse(is.na(k2), 0, ifelse(k2==1, 1, -1))) +
ifelse(is.na(k3), 0, ifelse(k3==1, 1, -1))
political %>%
mutate(pred = ifelse(is.na(k2), 0, ifelse(k2==1, 1, -1)) +
ifelse(is.na(k3), 0, ifelse(k3==1, 1, -1))
)
political %>%
mutate(pred = ifelse(is.na(k2), 0, ifelse(k2==1, 1, -1)) +
ifelse(is.na(k3), 0, ifelse(k3==1, 1, -1)) +
ifelse(is.na(k4), 0, ifelse(k4==1, 2, -1)) +
ifelse(is.na(k6), 0, ifelse(k6==1, 1, -1)) +
ifelse(is.na(k7), 0, ifelse(k7==1, 2, 0)) +
ifelse(is.na(k8), 0, ifelse(k8==1, 2, 0)) +
ifelse(is.na(k10), 0, ifelse(k10==1, -1, 0)) +
ifelse(is.na(k12), 0, ifelse(k12==1, -1, 0)) +
ifelse(is.na(k13), 0, ifelse(k13==1, 2, -1)) +
ifelse(is.na(k14), 0, ifelse(k14==1, 0, 0))
)
political %>%
mutate(pred = ifelse(is.na(k2), 0, ifelse(k2==1, 1, -1)) +
ifelse(is.na(k3), 0, ifelse(k3==1, 1, -1)) +
ifelse(is.na(k4), 0, ifelse(k4==1, 2, -1)) +
ifelse(is.na(k6), 0, ifelse(k6==1, 1, -1)) +
ifelse(is.na(k7), 0, ifelse(k7==1, 2, 0)) +
ifelse(is.na(k8), 0, ifelse(k8==1, 2, 0)) +
ifelse(is.na(k10), 0, ifelse(k10==1, -1, 0)) +
ifelse(is.na(k12), 0, ifelse(k12==1, -1, 0)) +
ifelse(is.na(k13), 0, ifelse(k13==1, 2, -1)) +
ifelse(is.na(k14), 0, ifelse(k14==1, 0, 0))
) %>%
ggplot(aes(pred)) + geom_bar()
political %>%
mutate(pred = ifelse(is.na(k2), 0, ifelse(k2==1, 1, -1)) +
ifelse(is.na(k3), 0, ifelse(k3==1, 1, -1)) +
ifelse(is.na(k4), 0, ifelse(k4==1, 2, -1)) +
ifelse(is.na(k6), 0, ifelse(k6==1, 1, -1)) +
ifelse(is.na(k7), 0, ifelse(k7==1, 2, 0)) +
ifelse(is.na(k8), 0, ifelse(k8==1, 2, 0)) +
ifelse(is.na(k10), 0, ifelse(k10==1, -1, 0)) +
ifelse(is.na(k12), 0, ifelse(k12==1, -1, 0)) +
ifelse(is.na(k13), 0, ifelse(k13==1, 3, -1)) +
ifelse(is.na(k14), 0, ifelse(k14==1, 0, 0)) +
5
) %>%
ggplot(aes(pred)) + geom_bar()
political %>%
mutate(pred = ifelse(is.na(k2), 0, ifelse(k2==1, 1, -1)) +
ifelse(is.na(k3), 0, ifelse(k3==1, 1, -1)) +
ifelse(is.na(k4), 0, ifelse(k4==1, 2, -1)) +
ifelse(is.na(k6), 0, ifelse(k6==1, 1, -1)) +
ifelse(is.na(k7), 0, ifelse(k7==1, 2, 0)) +
ifelse(is.na(k8), 0, ifelse(k8==1, 2, 0)) +
ifelse(is.na(k10), 0, ifelse(k10==1, -1, 0)) +
ifelse(is.na(k12), 0, ifelse(k12==1, -1, 0)) +
ifelse(is.na(k13), 0, ifelse(k13==1, 3, -1)) +
ifelse(is.na(k14), 0, ifelse(k14==1, 0, 0))
) %>%
ggplot(aes(pred)) + geom_bar()
political %>%
mutate(pred = ifelse(is.na(k2), 0, ifelse(k2==1, 1, -1)) +
ifelse(is.na(k3), 0, ifelse(k3==1, 1, -1)) +
ifelse(is.na(k4), 0, ifelse(k4==1, 2, -1)) +
ifelse(is.na(k6), 0, ifelse(k6==1, 1, -1)) +
ifelse(is.na(k7), 0, ifelse(k7==1, 2, 0)) +
ifelse(is.na(k8), 0, ifelse(k8==1, 2, 0)) +
ifelse(is.na(k10), 0, ifelse(k10==1, -1, 0)) +
ifelse(is.na(k12), 0, ifelse(k12==1, -1, 0)) +
ifelse(is.na(k13), 0, ifelse(k13==1, 3, -1)) +
ifelse(is.na(k14), 0, ifelse(k14==1, 0, 0)) +
5
) %>%
mutate(standardized_pred = ifelse(pred == c(-2,-1), 0,
ifelse(pred == c(0,1), 1,
ifelse(pred == c(2,3), 2,
ifelse(pred == c(4,5), 3,
ifelse(pred == c(6,7), 4,
ifelse(pred == c(8,9), 5,
ifelse(pred == c(10,11), 6,
ifelse(pred == c(12,13), 7,
ifelse(pred == c(14,15), 8, 9))))))))))
ggplot(aes(standardized_pred)) + geom_bar()
political %>%
mutate(pred = ifelse(is.na(k2), 0, ifelse(k2==1, 1, -1)) +
ifelse(is.na(k3), 0, ifelse(k3==1, 1, -1)) +
ifelse(is.na(k4), 0, ifelse(k4==1, 2, -1)) +
ifelse(is.na(k6), 0, ifelse(k6==1, 1, -1)) +
ifelse(is.na(k7), 0, ifelse(k7==1, 2, 0)) +
ifelse(is.na(k8), 0, ifelse(k8==1, 2, 0)) +
ifelse(is.na(k10), 0, ifelse(k10==1, -1, 0)) +
ifelse(is.na(k12), 0, ifelse(k12==1, -1, 0)) +
ifelse(is.na(k13), 0, ifelse(k13==1, 3, -1)) +
ifelse(is.na(k14), 0, ifelse(k14==1, 0, 0)) +
5
) %>%
mutate(standardized_pred = ifelse(pred == c(-2,-1), 0,
ifelse(pred == c(0,1), 1,
ifelse(pred == c(2,3), 2,
ifelse(pred == c(4,5), 3,
ifelse(pred == c(6,7), 4,
ifelse(pred == c(8,9), 5,
ifelse(pred == c(10,11), 6,
ifelse(pred == c(12,13), 7,
ifelse(pred == c(14,15), 8, 9)))))))))) %>%
ggplot(aes(standardized_pred)) + geom_bar()
political %>%
mutate(pred = ifelse(is.na(k2), 0, ifelse(k2==1, 1, -1)) +
ifelse(is.na(k3), 0, ifelse(k3==1, 1, -1)) +
ifelse(is.na(k4), 0, ifelse(k4==1, 2, -1)) +
ifelse(is.na(k6), 0, ifelse(k6==1, 1, -1)) +
ifelse(is.na(k7), 0, ifelse(k7==1, 2, 0)) +
ifelse(is.na(k8), 0, ifelse(k8==1, 2, 0)) +
ifelse(is.na(k10), 0, ifelse(k10==1, -1, 0)) +
ifelse(is.na(k12), 0, ifelse(k12==1, -1, 0)) +
ifelse(is.na(k13), 0, ifelse(k13==1, 3, -1)) +
ifelse(is.na(k14), 0, ifelse(k14==1, 0, 0)) +
5
) %>%
mutate(standardized_pred = ifelse(pred == c(-2,-1), 0,
ifelse(pred == c(0,1), 1,
ifelse(pred == c(2,3), 2,
ifelse(pred == c(4,5), 3,
ifelse(pred == c(6,7), 4,
ifelse(pred == c(8,9), 5,
ifelse(pred == c(10,11), 6,
ifelse(pred == c(12,13), 7,
ifelse(pred == c(14,15), 8, 9)))))))))) %>%
ggplot(aes(pred)) + geom_bar()
political %>%
mutate(pred = ifelse(is.na(k2), 0, ifelse(k2==1, 1, -1)) +
ifelse(is.na(k3), 0, ifelse(k3==1, 1, -1)) +
ifelse(is.na(k4), 0, ifelse(k4==1, 2, -1)) +
ifelse(is.na(k6), 0, ifelse(k6==1, 1, -1)) +
ifelse(is.na(k7), 0, ifelse(k7==1, 2, 0)) +
ifelse(is.na(k8), 0, ifelse(k8==1, 2, 0)) +
ifelse(is.na(k10), 0, ifelse(k10==1, -1, 0)) +
ifelse(is.na(k12), 0, ifelse(k12==1, -1, 0)) +
ifelse(is.na(k13), 0, ifelse(k13==1, 3, -1)) +
ifelse(is.na(k14), 0, ifelse(k14==1, 0, 0)) +
5
) %>%
mutate(standardized_pred = ifelse(pred == c(-2,-1), 0,
ifelse(pred == c(0,1), 1,
ifelse(pred == c(2,3), 2,
ifelse(pred == c(4,5), 3,
ifelse(pred == c(6,7), 4,
ifelse(pred == c(8,9), 5,
ifelse(pred == c(10,11), 6,
ifelse(pred == c(12,13), 7,
ifelse(pred == c(14,15), 8, 9)))))))))) %>%
ggplot(aes(standardized_pred)) + geom_bar()
kkk <- c(3,4,5)
kkk==c(1,3)
kkk%in%c(1,3)
political %>%
mutate(pred = ifelse(is.na(k2), 0, ifelse(k2==1, 1, -1)) +
ifelse(is.na(k3), 0, ifelse(k3==1, 1, -1)) +
ifelse(is.na(k4), 0, ifelse(k4==1, 2, -1)) +
ifelse(is.na(k6), 0, ifelse(k6==1, 1, -1)) +
ifelse(is.na(k7), 0, ifelse(k7==1, 2, 0)) +
ifelse(is.na(k8), 0, ifelse(k8==1, 2, 0)) +
ifelse(is.na(k10), 0, ifelse(k10==1, -1, 0)) +
ifelse(is.na(k12), 0, ifelse(k12==1, -1, 0)) +
ifelse(is.na(k13), 0, ifelse(k13==1, 3, -1)) +
ifelse(is.na(k14), 0, ifelse(k14==1, 0, 0)) +
5
) %>%
mutate(standardized_pred = ifelse(pred%in%c(-2,-1), 0,
ifelse(pred%in%c(0,1), 1,
ifelse(pred%in%c(2,3), 2,
ifelse(pred%in%c(4,5), 3,
ifelse(pred%in%c(6,7), 4,
ifelse(pred%in%c(8,9), 5,
ifelse(pred%in%c(10,11), 6,
ifelse(pred%in%c(12,13), 7,
ifelse(pred%in%c(14,15), 8, 9)))))))))) %>%
ggplot(aes(standardized_pred)) + geom_bar()
political %>%
mutate(pred = ifelse(is.na(k2), 0, ifelse(k2==1, 1, -1)) +
ifelse(is.na(k3), 0, ifelse(k3==1, 1, -1)) +
ifelse(is.na(k4), 0, ifelse(k4==1, 2, -1)) +
ifelse(is.na(k6), 0, ifelse(k6==1, 1, -1)) +
ifelse(is.na(k7), 0, ifelse(k7==1, 2, 0)) +
ifelse(is.na(k8), 0, ifelse(k8==1, 2, 0)) +
ifelse(is.na(k10), 0, ifelse(k10==1, -1, 0)) +
ifelse(is.na(k12), 0, ifelse(k12==1, -1, 0)) +
ifelse(is.na(k13), 0, ifelse(k13==1, 3, -1)) +
ifelse(is.na(k14), 0, ifelse(k14==1, 0, 0)) +
5
) %>%
mutate(standardized_pred = ifelse(pred==-2, 0,
ifelse(pred%in%c(-1,0), 1,
ifelse(pred%in%c(1,2), 2,
ifelse(pred%in%c(3,4), 3,
ifelse(pred%in%c(5,6), 4,
ifelse(pred%in%c(7,8), 5,
ifelse(pred%in%c(9,10), 6,
ifelse(pred%in%c(11,12), 7,
ifelse(pred%in%c(13,14), 8,
ifelse(pred%in%c(15,16), 9, 10
))))))))))) %>%
ggplot(aes(standardized_pred)) + geom_bar()
ggplot(political) + geom_bar(aes(ideo_self)) # total dist

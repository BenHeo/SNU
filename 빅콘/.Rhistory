library(tidyverse)
movie <- read.csv("dat.csv")
movie
head(movie)
names(movie)
unique(movie$name)
length(unique(movie$name))
length(movie$name)
unique(movie$name) %>%
anti_join(movie$name)
table(movie$name)
table(movie$name) > 1
table(movie$name)[table(movie$name) > 1]
movie %>%
filter(name %in% c("골든슬럼버", "미녀와야수", "스파이"))
movie %>%
filter(name %in% c("골든슬럼버", "미녀와야수", "스파이")) %>%
is.na()
movie %>%
filter(name %in% c("골든슬럼버", "미녀와야수", "스파이"))  %>%
select("actor3")
movie %>%
filter(name %in% c("골든슬럼버", "미녀와야수", "스파이"))  %>%
select("actor3") %>%
is.na()
movie %>%
filter(name %in% c("골든슬럼버", "미녀와야수", "스파이"))  %>%
select("actor3") %>%
filter(actor3 == "")
movie %>%
filter(name  == "")
movie %>%
filter(actor3  == "")
head(movie, 2)
library(stringr)
movie %>%
select(name)
movie %>%
select(name) %>%
str_split("[:,-]")
movie %>%
select(name) %>%
str_split(":|-|,")
movie %>%
select(name) %>%
str_split("a")
movie %>%
select(name) %>%
strsplit("a")
movie %>%
select(name)
strsplit(movie$name, "a")
movie$name
strsplit(movie[,"name"], "a")
str_split(movie[,"name"], "a")
str_split(movie[,"name"], ":")
str_split(movie[,"name"], ":")[2]
str_split(movie[,"name"], ":")[-2]
str_split(movie[,"name"], ":")[[2]]
str_split(movie[,"name"], ":")[1][2]
str_split(movie[,"name"], ":")[[1]][2]
str_split(movie[,"name"], ":")[896][2]
str_split(movie[,"name"], ":")[[896]][2]
str_split(movie[,"name"], ":")[[896]]
str_split(movie[,"name"], ":")[[896]][1]
str_split(movie[,"name"], ":")[[896]][2]
str_detect(movie$name, ":")
movie$name[str_detect(movie$name, ":")]
movie$name[str_detect(movie$name, ":|,")]
movie$name[str_detect(movie$name, ":|-")]
movie$name[str_detect(movie$name, ":|-|,")]
movie %>%
select(name) %>%
strsplit(":|-|,")
movie %>%
select(name) %>%
str_split(":|-|,")
str_split(movie$name, ":|-|,")
movie %>%
name("A특공대")
movie %>%
filter(name == "A 특공대")
movie %>%
filter(name == "A특공대")
movie %>%
filter(name %in% "특공대")
movie %>%
+ filter(name == "?특공대")
movie %>%
filter(name == "?특공대")
movie %>%
filter(name == "_특공대")
movie %>%
filter(name %like% "특공대")
?%like%
?"%like%"
??"%like%"
library(data.table)
movie %>%
filter(name %like% "특공대")
movie$name[str_split(movie$name, ":|-|,")]
str_split(movie$name, ":|-|,")
movie %>%
filter(name %like% "인디펜던스데")
a <- str_split(movie$name, ":|-|,")
row_bind(a)
bind_rows(a)
bind_rows(name = a)
unlist(a)
word(movie$name, ":")
word(movie$name, 1, ":")
word(movie$name, 1, sep = ":")
movie %>%
filter(name %like% "A-특공")
movie %>%
filter(name %like% "분노의질")
word(movie$name, 1, sep = ":|-|,|!")
movie %>%
select(name) %>%
mutate(magic7 = word(movie$name, 1, sep = ":|-|,|!"))
movie %>%
select(name) %>%
mutate(magic7 = word(movie$name, 1, sep = ":|-|,|!")) %>%
head()
movie %>%
select(name) %>%
mutate(magic7 = ifelse(length(word(movie$name, 1, sep = ":|-|,|!")) <= 7, 1, 0)) %>%
head()
movie %>%
select(name) %>%
mutate(magic7 = ifelse(length(word(movie$name, 1, sep = ":|-|,|!")) <= 7, 1, 0)) %>%
head(20)
length(word(movie$name, 1, sep = ":|-|,|!"))
movie %>%
select(name) %>%
mutate(magic7 = ifelse(nchar(word(movie$name, 1, sep = ":|-|,|!")) <= 7, 1, 0)) %>%
head(20)
ggplot(movie) + geom_boxplot(aes(x=magic7, y=audience))
movie <- movie %>%
select(name) %>%
mutate(magic7 = ifelse(nchar(word(movie$name, 1, sep = ":|-|,|!")) <= 7, 1, 0)) # if less than or equal to 7 then 1
ggplot(movie) + geom_boxplot(aes(x=magic7, y=audience))
names(movie)
movie <- read.csv("dat.csv")
names(movie)
movie <- movie %>%
mutate(magic7 = ifelse(nchar(word(movie$name, 1, sep = ":|-|,|!")) <= 7, 1, 0)) # if less than or equal to 7 then 1
names(movie)
ggplot(movie) + geom_boxplot(aes(x=magic7, y=audience))
head(movie, 2)
movie <- movie %>%
mutate(magic7 = as.factor(ifelse(nchar(word(movie$name, 1, sep = ":|-|,|!")) <= 7, 1, 0))) # if less than or equal to 7 then 1
ggplot(movie) + geom_boxplot(aes(x=magic7, y=audience))
ggplot(movie) + geom_boxplot(aes(x=magic7, y=log(audience)))
movie <- movie %>%
mutate(magic7 = as.factor(ifelse(nchar(word(movie$name, 1, sep = ":|-|,|!")) <= 7 &
nchar(word(movie$name, 1, sep = ":|-|,|!")) > 1, 1, 0))) # if less than or equal to 7 then 1
ggplot(movie) + geom_boxplot(aes(x=magic7, y=audience))
movie <- movie %>%
mutate(magic7 = as.factor(ifelse(nchar(word(movie$name, 1, sep = ":|-|,|!")) <= 7 &
nchar(word(movie$name, 1, sep = ":|-|,|!")) > 2, 1, 0))) # if less than or equal to 7 then 1
ggplot(movie) + geom_boxplot(aes(x=magic7, y=audience))
movie <- movie %>%
mutate(magic7 = as.factor(ifelse(nchar(word(movie$name, 1, sep = ":|-|,|!")) <= 7 &
nchar(word(movie$name, 1, sep = ":|-|,|!")) > 1, 1, 0))) # if less than or equal to 7 then 1
ggplot(movie) + geom_boxplot(aes(x=magic7, y=audience))
movie <- movie %>%
mutate(magic7 = as.factor(ifelse(nchar(word(movie$name, 1, sep = ":|-|,|!")) <= 7 &
nchar(word(movie$name, 1, sep = ":|-|,|!")) > 0, 1, 0))) # if less than or equal to 7 then 1
ggplot(movie) + geom_boxplot(aes(x=magic7, y=audience))
movie <- movie %>%
mutate(magic7 = as.factor(ifelse(nchar(word(movie$name, 1, sep = ":|-|,|!")) <= 7 &
nchar(word(movie$name, 1, sep = ":|-|,|!")) > 1, 1, 0))) # if less than or equal to 7 then 1
ggplot(movie) + geom_boxplot(aes(x=magic7, y=audience))
movie %>%
mutate(main_actors = ifelse(actor1 == "", 0, 1) + ifelse(actor2 == "", 0, 1) + ifelse(actor3 == "", 0, 1))
movie <- movie %>%
mutate(main_actors = ifelse(actor1 == "", 0, 1) + ifelse(actor2 == "", 0, 1) + ifelse(actor3 == "", 0, 1))
movie <- movie %>%
mutate(main_actors = as.factor(ifelse(actor1 == "", 0, 1) + ifelse(actor2 == "", 0, 1) + ifelse(actor3 == "", 0, 1)))
ggplot(movie) + geom_boxplot(aes(x=main_actors, y=audience))
ggplot(movie) + geom_point(aes(x=main_actors, y=audience))
as.factor(movie[, "name", "actor1", "actor1"])
as.factor(movie[, "name", "actor1", "actor2"])
movie[, "name", "actor1", "actor2"]
as.factor(movie[, c("name", "actor1", "actor2")])
summary(movie)
movie %>%
mutate(country = ifelse(country == "미국", 1, ifelse(country == "한국", 2, 0)))
movie <- movie %>%
mutate(country = ifelse(country == "미국", 1, ifelse(country == "한국", 2, 0))) # 1: 미국, 2: 한국, 3: 기타국
summary(movie)
movie <- movie %>%
mutate(country = as.factor(ifelse(country == "미국", 1, ifelse(country == "한국", 2, 0)))) # 1: 미국, 2: 한국, 3: 기타국
summary(movie)
movie <- movie %>%
mutate(country = as.factor(ifelse(country == "미국", 1, ifelse(country == "한국", 2, 0)))) # 1: 미국, 2: 한국, 3: 기타국
head(movie, 2)
movie <- read.csv("dat.csv")
head(movie, 2)
summary(movie)
names(movie)
table(movie$name)[table(movie$name) > 1]
movie <- movie %>%
mutate(country = as.factor(ifelse(country == "미국", 1, ifelse(country == "한국", 2, 0)))) # 1: 미국, 2: 한국, 3: 기타국
summary(movie)
movie <- movie %>%
mutate(magic7 = as.factor(ifelse(nchar(word(movie$name, 1, sep = ":|-|,|!")) <= 7 &
nchar(word(movie$name, 1, sep = ":|-|,|!")) > 1, 1, 0))) # if less than or equal to 7 then 1
ggplot(movie) + geom_boxplot(aes(x=magic7, y=audience))
movie <- movie %>%
mutate(main_actors = as.factor(ifelse(actor1 == "", 0, 1) + ifelse(actor2 == "", 0, 1) + ifelse(actor3 == "", 0, 1)))
ggplot(movie) + geom_point(aes(x=main_actors, y=audience))
ggplot(movie) + geom_boxplot(aes(x=main_actors, y=audience))
head(movie, 2)
lm.fit <- lm(audience~.-name, data = movie)
summary(lm.fit)
lm.pred <- predict(lm.fit, movie)
movie %>%
gather(actor1, actor2, actor3, key = "actor", value = "1")
movie %>%
gather(actor1, actor2, actor3, key = "actor", value = "1") %>%
select(-(1:3))
ncol(movie)
movie %>%
gather(actor1, actor2, actor3, key = "actor", value = "1") %>%
select(17:18)
movie %>%
gather(actor1, actor2, actor3, key = "actor", value = "1") %>%
select(1)
movie %>%
gather(actor1, actor2, actor3, key = "actor", value = "1") %>%
select(17)
movie %>%
gather(key, value, actor1:actor3) %>%
filter(value != "")
movie %>%
gather(key, value, actor1:actor3) %>%
filter(value != "") %>%
group_by(key) %>%
summarise(actor_power = mean(audience))
movie %>%
gather(key, value, actor1:actor3) %>%
filter(value != "") %>%
group_by(value) %>%
summarise(actor_power = mean(audience))
movie %>%
gather(key, value, actor1:actor3) %>%
filter(value != "")
movie %>%
gather(key, value, actor1:actor3) %>%
filter(value != "") %>%
group_by(value) %>%
summarise(actor_power = mean(audience)) %>%
filter(actor1 = '휴잭')
movie %>%
gather(key, value, actor1:actor3) %>%
filter(value != "") %>%
group_by(value) %>%
summarise(actor_power = mean(audience)) %>%
filter(actor1 == '휴잭')
movie %>%
gather(key, value, actor1:actor3) %>%
filter(value != "") %>%
group_by(value) %>%
summarise(actor_power = mean(audience)) %>%
filter(actor1 == '휴잭맨')
movie %>%
gather(key, value, actor1:actor3) %>%
filter(value != "") %>%
group_by(value) %>%
summarise(actor_power = mean(audience)) %>%
filter(value == '휴잭맨')
movie %>%
filter(actor1 == '휴잭맨' | actor2 == '휴잭맨' | actor3 == '휴잭맨')
movie %>%
gather(key, value, actor1:actor3) %>%
filter(value != "") %>%
group_by(value) %>%
summarise(actor_power = mean(audience)) %>%
select(value, actor_power)
movie %>%
gather(key, value, actor1:actor3) %>%
filter(value != "") %>%
group_by(value) %>%
summarise(actor_power = mean(audience)) %>%
select(value, actor_power) %>%
filter(value == "휴잭")
movie %>%
gather(key, value, actor1:actor3) %>%
filter(value != "") %>%
group_by(value) %>%
summarise(actor_power = mean(audience)) %>%
select(value, actor_power) %>%
filter(value == "휴잭맨")
movie %>%
gather(key, value, actor1:actor3) %>%
filter(value != "") %>%
group_by(value) %>%
summarise(actor_power = mean(audience)) %>%
select(value, actor_power) %>%
filter(value == "김유정")
as.character(movie$actor1)
movie %>%
gather(key, value, as.character(actor1), as.character(actor2), as.character(actor3)) %>%
filter(value != "") %>%
group_by(value) %>%
summarise(actor_power = mean(audience)) %>%
select(value, actor_power) %>%
filter(value == "김유정")
head(movie, 2)
movie$actor1 <- as.character(movie$actor1)
summary(movie)
movie$actor2 <- as.character(movie$actor2)
movie$actor3 <- as.character(movie$actor3)
movie %>%
gather(key, value, actor1:actor3) %>%
filter(value != "") %>%
group_by(value) %>%
summarise(actor_power = mean(audience)) %>%
select(value, actor_power) %>%
filter(value == "김유정")
movie %>%
gather(key, value, actor1:actor3) %>%
filter(value != "") %>%
group_by(value) %>%
summarise(actor_power = mean(audience)) %>%
select(value, actor_power)
movie %>%
gather(key, value, actor1:actor3) %>%
filter(value != "") %>%
group_by(value) %>%
summarise(actor_power = mean(audience)) %>%
select(value, actor_power) %>%
View()
movie %>%
select(actor1:actor3)
movie %>%
select(actor1:actor3) %>%
str_detect("?")
movie %>%
select(actor1:actor3) %>%
filter(actor1 %like% "?")
movie %>%
select(actor1:actor3) %>%
filter(actor1 %like% "//?")
movie %>%
select(actor1:actor3) %>%
filter(actor1 %like% "/?")
movie %>%
select(actor1:actor3) %>%
filter(actor1 %like% "\\?")
movie %>%
select(actor1:actor3) %>%
filter(actor1 %like% "\\?" | actor2 %like% "\\?" | actor3 %like% "\\?")
movie %>%
filter(actor1 %like% "\\?" | actor2 %like% "\\?" | actor3 %like% "\\?")
